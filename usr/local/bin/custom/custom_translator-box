#!/bin/bash

#   Filename    :   custom_translator-box
#   Filetype    :   Bash shell script
#   Description :   online text translator (en â†’ el)

#   CHECK IF ZENITY IS INSTALLED, EXIT IF NOT
if ! [[ `which zenity` ]]; then
    if [[ `which notify-send` ]]; then
        # send a notification if possible
        notify-send -t 4000 "This script requires zenity to run.
You can install zenity with
sudo apt-get install zenity"
    else
        # fallback message
        echo -e "This script requires zenity to run.
You can install zenity with the command
\033[1msudo apt-get install zenity\033[0m"
    fi
    exit
fi

#   PROMPT FOR INITIAL TO-BE-TRANSLATED TEXT INPUT
INPUT_TEXT=$(zenity --entry                                                 \
                    --title="Translator box"                                \
                    --width=400                                             \
                    --text='Type "quit" to exit...'
                    )

#   NEXT TEXT INPUT LOOP, EXIT ON "quit"
while [ "$INPUT_TEXT" != "quit" ]; do
    ENCODED_TEXT=$(echo -n "$INPUT_TEXT" | perl -pe's/([^-_.~A-Za-z0-9])/sprintf("%%%02X", ord($1))/seg');
    OUTPUT_URL="https://translate.google.gr/?hl=el#en/el/$ENCODED_TEXT"
    xdg-open "$OUTPUT_URL"

    INPUT_TEXT=$(zenity --entry                                             \
                        --title="Translator box"                            \
                        --width=400                                         \
                        --text='Type "quit" to exit...'
                        )
done
